<?php
$activeCategory = $_GET['category'] ?? 'logo';

// شبیه سازی اطلاعاتی که از پنل ذخیره شده
$portfolioItems = [
    ['category'=>'logo', 'src'=>'./uploads/logo1.webp', 'title'=>'لوگوی شرکت X'],
    ['category'=>'logo', 'src'=>'./uploads/logo2.webp', 'title'=>'لوگوی برند Y'],
    ['category'=>'social-media', 'src'=>'./uploads/social1.webp', 'title'=>'پیج اینستاگرام Z'],
    ['category'=>'banner', 'src'=>'./uploads/banner1.webp', 'title'=>'بیلبورد تابستانه'],
];

// فیلتر آیتم‌های دسته انتخاب شده
$activeItems = array_filter($portfolioItems, fn($item) => $item['category'] === $activeCategory);
?>

<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>نمونه کارها</title>
<link rel="stylesheet" href="./styles/output.css">
<style>
body { font-family: sans-serif; background:#f0f0f0; margin:0; padding:0;}
header { display:flex; justify-content: space-between; align-items:center; padding:1rem; background:#fff; border-bottom:1px solid #ccc;}
.tab-btn { margin:0 0.5rem; padding:0.5rem 1rem; cursor:pointer; border:none; background:none; font-weight:bold; position:relative;}
.tab-btn.active::after { content:""; position:absolute; bottom:0; left:0; width:100%; height:2px; background:black;}
.gallery-item { position:relative; margin:1rem 0; cursor:pointer;}
.gallery-item img { width:100%; border-radius:5px; transition: transform 0.3s ease;}
.gallery-item:hover img { transform: scale(1.05);}
.overlay { position:absolute; bottom:5px; left:5px; background:rgba(0,0,0,0.5); color:#fff; padding:5px 10px; border-radius:3px;}
#lightbox { position:fixed; inset:0; background:rgba(0,0,0,0.8); display:none; align-items:center; justify-content:center; z-index:1000;}
#lightbox img { max-width:90%; max-height:90%; border-radius:5px;}
#lightbox-close { position:absolute; top:20px; right:20px; font-size:2rem; color:#fff; cursor:pointer;}
</style>
</head>
<body>

<header>
    <div>نمونه کارها</div>
    <div>
        <button class="tab-btn <?= $activeCategory==='logo'?'active':''?>" data-category="logo">Logo</button>
        <button class="tab-btn <?= $activeCategory==='social-media'?'active':''?>" data-category="social-media">Social media</button>
        <button class="tab-btn <?= $activeCategory==='banner'?'active':''?>" data-category="banner">Banner</button>
    </div>
</header>

<main style="padding:1rem; max-width:900px; margin:auto;">
<?php foreach($activeItems as $item): ?>
<div class="gallery-item" data-title="<?= $item['title'] ?>">
    <img src="<?= $item['src'] ?>" alt="<?= $item['title'] ?>" class="lightbox-img">
    <div class="overlay"><?= $item['title'] ?></div>
</div>
<?php endforeach; ?>
</main>

<div id="lightbox">
    <span id="lightbox-close">&times;</span>
    <img id="lightbox-img" src="" alt="">
</div>

<script>
// مدیریت تب‌ها
const tabs = document.querySelectorAll('.tab-btn');
tabs.forEach(tab=>{
    tab.addEventListener('click', ()=>{
        tabs.forEach(t=>t.classList.remove('active'));
        tab.classList.add('active');
        const category = tab.dataset.category;
        window.location.href = '?category=' + category; // لود دوباره با PHP
    });
});

// لایت‌باکس
const lightbox = document.getElementById('lightbox');
const lightboxImg = document.getElementById('lightbox-img');
const closeBtn = document.getElementById('lightbox-close');

document.querySelectorAll('.lightbox-img').forEach(img=>{
    img.addEventListener('click', ()=>{
        lightboxImg.src = img.src;
        lightboxImg.alt = img.dataset.title;
        lightbox.style.display = 'flex';
    });
});

closeBtn.addEventListener('click', ()=>lightbox.style.display='none');
lightbox.addEventListener('click', e=>{
    if(e.target===lightbox) lightbox.style.display='none';
});
</script>

</body>
</html>
